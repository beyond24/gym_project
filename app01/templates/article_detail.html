{% extends 'layout.html' %}
{% load my_filters_and_tags %}

{% block breadcrumb %}
    <li><a href="/article/list">精彩文章</a></li>
    <li class="active">文章详情</li>
{% endblock %}

{% block content %}


<main class="container">

    <div class="container">
        <!-- 标题及作者 -->
        <h1 class="col-12 mt-4 mb-4">{{ article.title }}</h1>
        <div class="col-12 alert alert-success">
            <div>
                作者：{{ article.author }}
            </div>
            <div>
                浏览：{{ article.total_views }}
            </div>
        </div>

        <!-- 文章正文 -->
        <div class="col-12">
            <p>{{ article.body|safe }}</p>
        </div>
    </div>

    <!-- 发表评论 -->
    <div class="container">
        <hr>
        {% if request.session.info %}
            <div>
                <form action="{% url 'post_comment' article.id %}" method="POST">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="body">
                            <strong>
                                我要发言：
                            </strong>
                        </label>
                        <div>
                            {{ comment_form.media }}
                            {{ comment_form.body }}
                        </div>
                        {#                    <span style="color: red">{{ form.error.0 }}</span>#}
                    </div>
                    <!-- 提交按钮 -->
                    <button type="submit" class="btn btn-primary ">发送</button>
                </form>
            </div>
            <br>
        {% else %}
            <br>
            <h5 class="row justify-content-center">
                请<a href="{% url 'login' %}">登录</a>后回复
            </h5>
            <br>
        {% endif %}

    </div>


    <!-- 显示评论 -->

    <div class="container" style="margin-bottom: 10em">
        <h4>共有{{ comments.count }}条评论</h4>
        {% for comment in comments %}
            <hr>
            <p>
                <strong style="color: #fc2f52">
                    {{ comment.user }}
                </strong> 于
                <span style="color: #2885ea">
                    {{ comment.created|timesince_zh }}
                </span> 时说：
            </p>
            <pre style="font-family: inherit; font-size: 1em;">{{ comment.body|safe }}</pre>
        {% endfor %}
    </div>

</main>






{% endblock %}